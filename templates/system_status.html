{% extends "base.html" %}
{% block content %}

<style>
    :root {
        --card-radius: 16px;
        --shadow-sm: 0 2px 8px rgba(0,0,0,0.04);
        --shadow-md: 0 5px 15px rgba(0,0,0,0.08);
    }

    .status-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
    }

    .status-header {
        text-align: center;
        margin-bottom: 40px;
    }

    .status-header h1 {
        font-size: 2.5rem;
        font-weight: 800;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        margin-bottom: 10px;
    }

    .status-header p {
        color: #6c757d;
        font-size: 1.1rem;
    }

    .status-card {
        background: white;
        border-radius: var(--card-radius);
        box-shadow: var(--shadow-md);
        padding: 30px;
        margin-bottom: 25px;
        border-left: 5px solid;
    }

    .status-card.database { border-left-color: #10ac84; }
    .status-card.environment { border-left-color: #48dbfb; }
    .status-card.records { border-left-color: #feca57; }

    .status-card h3 {
        font-size: 1.5rem;
        font-weight: 700;
        margin-bottom: 20px;
        color: #2d3436;
    }

    .info-row {
        display: flex;
        justify-content: space-between;
        padding: 12px 0;
        border-bottom: 1px solid #f0f0f0;
    }

    .info-row:last-child {
        border-bottom: none;
    }

    .info-label {
        font-weight: 600;
        color: #636e72;
        flex: 0 0 250px;
    }

    .info-value {
        color: #2d3436;
        font-family: 'Courier New', monospace;
        flex: 1;
        text-align: right;
        word-break: break-all;
    }

    .badge-status {
        display: inline-block;
        padding: 6px 16px;
        border-radius: 20px;
        font-weight: 600;
        font-size: 0.9rem;
    }

    .badge-success {
        background: linear-gradient(135deg, #1dd1a1 0%, #10ac84 100%);
        color: white;
    }

    .badge-warning {
        background: linear-gradient(135deg, #feca57 0%, #ff9f43 100%);
        color: white;
    }

    .badge-danger {
        background: linear-gradient(135deg, #ff6b6b 0%, #ee5253 100%);
        color: white;
    }

    .badge-info {
        background: linear-gradient(135deg, #48dbfb 0%, #0abde3 100%);
        color: white;
    }

    .alert-box {
        padding: 20px;
        border-radius: 12px;
        margin-bottom: 25px;
        display: flex;
        align-items: center;
        gap: 15px;
    }

    .alert-box.success {
        background: #d4edda;
        border: 1px solid #c3e6cb;
        color: #155724;
    }

    .alert-box.warning {
        background: #fff3cd;
        border: 1px solid #ffeaa7;
        color: #856404;
    }

    .alert-icon {
        font-size: 2rem;
    }

    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin-top: 15px;
    }

    .stat-box {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 20px;
        border-radius: 12px;
        text-align: center;
    }

    .stat-box h4 {
        font-size: 0.9rem;
        opacity: 0.9;
        margin-bottom: 8px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .stat-box .number {
        font-size: 2rem;
        font-weight: 800;
    }
</style>

<div class="status-container">
    <!-- Header -->
    <div class="status-header">
        <h1>System Status</h1>
        <p>‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</p>
    </div>

    <!-- Alert Box -->
    {% if status.db_exists and status.volume_path != "Not Configured" %}
    <div class="alert-box success">
        <div class="alert-icon">‚úÖ</div>
        <div>
            <strong>‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥!</strong><br>
            ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö Railway Volume ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏´‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏á deploy
        </div>
    </div>
    {% elif status.volume_path == "Not Configured" %}
    <div class="alert-box warning">
        <div class="alert-icon">‚ö†Ô∏è</div>
        <div>
            <strong>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Railway Volume!</strong><br>
            ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏≤‡∏à‡∏´‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏á deploy ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Volume ‡∏ï‡∏≤‡∏°‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠ RAILWAY_VOLUME_SETUP.md
        </div>
    </div>
    {% endif %}

    <!-- Database Information -->
    <div class="status-card database">
        <h3>üìÅ Database Information</h3>

        <div class="info-row">
            <div class="info-label">Database Location:</div>
            <div class="info-value">
                {% if status.volume_path != "Not Configured" %}
                    <span class="badge-status badge-success">{{ status.db_location }}</span>
                {% else %}
                    <span class="badge-status badge-warning">{{ status.db_location }}</span>
                {% endif %}
            </div>
        </div>

        <div class="info-row">
            <div class="info-label">Database Path:</div>
            <div class="info-value">{{ status.db_path }}</div>
        </div>

        <div class="info-row">
            <div class="info-label">Volume Mount Path:</div>
            <div class="info-value">
                {% if status.volume_path != "Not Configured" %}
                    <span class="badge-status badge-success">{{ status.volume_path }}</span>
                {% else %}
                    <span class="badge-status badge-danger">{{ status.volume_path }}</span>
                {% endif %}
            </div>
        </div>

        <div class="info-row">
            <div class="info-label">Database File:</div>
            <div class="info-value">
                {% if status.db_exists %}
                    <span class="badge-status badge-success">Exists</span>
                {% else %}
                    <span class="badge-status badge-danger">Not Found</span>
                {% endif %}
            </div>
        </div>

        <div class="info-row">
            <div class="info-label">Database Size:</div>
            <div class="info-value"><strong>{{ status.db_size }}</strong></div>
        </div>
    </div>

    <!-- Records Statistics -->
    <div class="status-card records">
        <h3>üìä Database Records</h3>

        <div class="stats-grid">
            <div class="stat-box">
                <h4>Orders</h4>
                <div class="number">{{ "{:,}".format(status.total_orders) }}</div>
            </div>
            <div class="stat-box">
                <h4>Products</h4>
                <div class="number">{{ "{:,}".format(status.total_products) }}</div>
            </div>
            <div class="stat-box">
                <h4>Shops</h4>
                <div class="number">{{ "{:,}".format(status.total_shops) }}</div>
            </div>
            <div class="stat-box">
                <h4>Users</h4>
                <div class="number">{{ "{:,}".format(status.total_users) }}</div>
            </div>
        </div>
    </div>

    <!-- Environment Variables -->
    <div class="status-card environment">
        <h3>üîß Environment Variables</h3>

        {% for key, value in status.env_vars.items() %}
        <div class="info-row">
            <div class="info-label">{{ key }}:</div>
            <div class="info-value">
                {% if value == "Not Set" %}
                    <span class="badge-status badge-danger">{{ value }}</span>
                {% else %}
                    {{ value }}
                {% endif %}
            </div>
        </div>
        {% endfor %}
    </div>

    <!-- Back Button -->
    <div style="text-align: center; margin-top: 30px;">
        <a href="{{ url_for('dashboard') }}" class="btn btn-primary btn-lg" style="border-radius: 10px; padding: 12px 40px;">
            ‚Üê ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
        </a>
    </div>
</div>

{% endblock %}
